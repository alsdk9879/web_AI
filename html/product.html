<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Premium Exotic Cars</title>
        <link rel="stylesheet" href="../css/style.css" />
        <link rel="stylesheet" href="../css/responsive.css" />
        <link
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
            rel="stylesheet"
        />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/11.0.5/swiper-bundle.min.css"
        />
    </head>
    <body>
        <!-- header -->
        <div id="header"></div>

        <!-- Nav -->
        <div id="nav"></div>

        <!-- Product Detail -->
        <section class="product-detail">
            <div class="container">
                <div class="product-layout">
                    <!-- Product Images -->
                    <div class="product-images">
                        <!-- Main Image -->
                        <div class="main-image">
                            <div class="swiper product-swiper">
                                <div class="swiper-wrapper">
                                    <div class="swiper-slide">
                                        <img
                                            src="https://images.unsplash.com/photo-1552519507-da3b142c6e3d?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80"
                                            alt="2024 Bentley Continental GT Speed"
                                        />
                                    </div>
                                    <div class="swiper-slide">
                                        <img
                                            src="https://images.unsplash.com/photo-1563720223185-11003d516935?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80"
                                            alt="2024 Bentley Continental GT Speed Interior"
                                        />
                                    </div>
                                    <div class="swiper-slide">
                                        <img
                                            src="https://images.unsplash.com/photo-1449824913935-59a10b8d2000?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80"
                                            alt="2024 Bentley Continental GT Speed Side"
                                        />
                                    </div>
                                    <div class="swiper-slide">
                                        <img
                                            src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80"
                                            alt="2024 Bentley Continental GT Speed Rear"
                                        />
                                    </div>
                                    <div class="swiper-slide">
                                        <img
                                            src="https://images.unsplash.com/photo-1566473965997-3de9c817e938?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80"
                                            alt="2024 Bentley Continental GT Speed Detail"
                                        />
                                    </div>
                                    <div class="swiper-slide">
                                        <img
                                            src="https://images.unsplash.com/photo-1583121274602-3e2820c69888?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80"
                                            alt="2024 Bentley Continental GT Speed Engine"
                                        />
                                    </div>
                                </div>
                                <div class="swiper-button-next"></div>
                                <div class="swiper-button-prev"></div>
                                <div class="swiper-pagination"></div>
                            </div>
                        </div>

                        <!-- Thumbnail Images -->
                        <div class="thumbnail-images">
                            <div class="thumbnail active" data-slide="0">
                                <img
                                    src="https://images.unsplash.com/photo-1552519507-da3b142c6e3d?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&q=80"
                                    alt="Thumbnail 1"
                                />
                            </div>
                            <div class="thumbnail" data-slide="1">
                                <img
                                    src="https://images.unsplash.com/photo-1563720223185-11003d516935?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&q=80"
                                    alt="Thumbnail 2"
                                />
                            </div>
                            <div class="thumbnail" data-slide="2">
                                <img
                                    src="https://images.unsplash.com/photo-1449824913935-59a10b8d2000?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&q=80"
                                    alt="Thumbnail 3"
                                />
                            </div>
                            <div class="thumbnail" data-slide="3">
                                <img
                                    src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&q=80"
                                    alt="Thumbnail 4"
                                />
                            </div>
                            <div class="thumbnail" data-slide="4">
                                <img
                                    src="https://images.unsplash.com/photo-1566473965997-3de9c817e938?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&q=80"
                                    alt="Thumbnail 5"
                                />
                            </div>
                            <div class="thumbnail" data-slide="5">
                                <img
                                    src="https://images.unsplash.com/photo-1583121274602-3e2820c69888?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&q=80"
                                    alt="Thumbnail 6"
                                />
                            </div>
                            <div class="more-images">+0</div>
                        </div>
                    </div>

                    <!-- Product Info -->
                    <div class="product-info">
                        <h1>2024 BENTLEY CONTINENTAL GT SPEED</h1>
                        <div class="product-price">
                            <span class="price-label">Call for Price</span>
                        </div>

                        <!-- Action Buttons -->
                        <div class="product-actions">
                            <button class="btn-primary">
                                ADD TO SELECTION
                            </button>
                            <button class="btn-secondary">
                                CHECK AVAILABILITY
                            </button>
                            <button class="btn-icon">
                                <i class="fas fa-heart"></i>
                            </button>
                        </div>

                        <!-- Contact Dealer -->
                        <div class="contact-dealer">
                            <h4>CONTACT THE DEALER</h4>
                            <p class="dealer-mileage">1,000 Miles</p>
                            <div class="dealer-contact">
                                <button class="contact-btn">
                                    <i class="fas fa-phone"></i>
                                    CALL • (111)222-3333
                                </button>
                            </div>
                        </div>

                        <!-- Dealer Information -->
                        <div class="dealer-info">
                            <h4>DEALER INFORMATION</h4>
                            <div class="dealer-details">
                                <p>
                                    <strong>Dealer:</strong> Spongebob
                                    SquarePants
                                </p>
                                <div class="dealer-rating">
                                    <i class="fas fa-star"></i>
                                    <span>7.5 cars on YungGallery</span>
                                </div>
                                <div class="dealer-address">
                                    <p>
                                        124 Conch Street, Bikini Bottom, Pacific
                                        Ocean
                                    </p>
                                    <a href="#" class="view-map"
                                        >View on Google maps</a
                                    ><br />
                                    <a href="#" class="website-link">Website</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Product Details Tabs -->
        <section class="product-tabs">
            <div class="container">
                <!-- Tab Navigation -->
                <div class="tab-nav">
                    <button class="tab-btn active" data-tab="overview">
                        Overview
                    </button>
                    <button class="tab-btn" data-tab="specs">Specs</button>
                    <button class="tab-btn" data-tab="services">
                        Services
                    </button>
                </div>

                <!-- Tab Content -->
                <div class="tab-content">
                    <!-- Overview Tab -->
                    <div class="tab-pane active" id="overview">
                        <div class="overview-content">
                            <p>
                                The 2024 Bentley Continental GT Speed embodies
                                the pinnacle of performance and luxury. With its
                                bold design, handcrafted interior, and powerful
                                W12 engine, this grand tourer delivers an
                                exhilarating driving experience unlike any
                                other. Featuring advanced all-wheel-drive
                                system, precision-tuned suspension, and
                                cutting-edge technology, the Continental GT
                                Speed blends elegance and raw power with
                                effortless grace.
                            </p>
                        </div>
                    </div>

                    <!-- Specs Tab -->
                    <div class="tab-pane" id="specs">
                        <div class="specs-grid">
                            <div class="spec-group">
                                <div class="spec-item">
                                    <i class="fas fa-car"></i>
                                    <div class="spec-info">
                                        <span class="spec-label">Make</span>
                                        <span class="spec-value">Bentley</span>
                                    </div>
                                </div>
                                <div class="spec-item">
                                    <i class="fas fa-cog"></i>
                                    <div class="spec-info">
                                        <span class="spec-label">Stock #</span>
                                        <span class="spec-value">8883</span>
                                    </div>
                                </div>
                                <div class="spec-item">
                                    <i class="fas fa-palette"></i>
                                    <div class="spec-info">
                                        <span class="spec-label"
                                            >Body Style</span
                                        >
                                        <span class="spec-value">Coupe</span>
                                    </div>
                                </div>
                            </div>

                            <div class="spec-group">
                                <div class="spec-item">
                                    <i class="fas fa-tag"></i>
                                    <div class="spec-info">
                                        <span class="spec-label">Model</span>
                                        <span class="spec-value"
                                            >Continental GT Speed</span
                                        >
                                    </div>
                                </div>
                                <div class="spec-item">
                                    <i class="fas fa-calendar"></i>
                                    <div class="spec-info">
                                        <span class="spec-label">Year</span>
                                        <span class="spec-value">2024</span>
                                    </div>
                                </div>
                                <div class="spec-item">
                                    <i class="fas fa-engine"></i>
                                    <div class="spec-info">
                                        <span class="spec-label">Engine</span>
                                        <span class="spec-value"
                                            >Twin-Turbo 6.0L W12</span
                                        >
                                    </div>
                                </div>
                            </div>

                            <div class="spec-group">
                                <div class="spec-item">
                                    <i class="fas fa-barcode"></i>
                                    <div class="spec-info">
                                        <span class="spec-label">VIN</span>
                                        <span class="spec-value"
                                            >SNGZ23UCZ2390CNW</span
                                        >
                                    </div>
                                </div>
                                <div class="spec-item">
                                    <i class="fas fa-road"></i>
                                    <div class="spec-info">
                                        <span class="spec-label">Mileage</span>
                                        <span class="spec-value"
                                            >1,000 miles</span
                                        >
                                    </div>
                                </div>
                                <div class="spec-item">
                                    <i class="fas fa-gas-pump"></i>
                                    <div class="spec-info">
                                        <span class="spec-label"
                                            >Engine Type</span
                                        >
                                        <span class="spec-value"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Services Tab -->
                    <div class="tab-pane" id="services">
                        <div class="services-grid">
                            <div class="service-item">
                                <h4>Insurance</h4>
                            </div>
                            <div class="service-item">
                                <h4>Product</h4>
                            </div>
                            <div class="service-item">
                                <h4>Ship</h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- More from This Dealer -->
        <section class="more-from-dealer">
            <div class="container">
                <h2>MORE FROM THIS DEALER</h2>
                <div class="dealer-cars-grid">
                    <div class="dealer-car">
                        <img
                            src="https://images.unsplash.com/photo-1552519507-da3b142c6e3d?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80"
                            alt="2024 Bentley Continental GT Speed"
                        />
                        <div class="car-info">
                            <h4>2024 Bentley Continental GT Speed</h4>
                            <p class="car-price">$367,960</p>
                        </div>
                        <div class="car-badge">
                            W12 SPEED LAST OF THE W12 ENGINES
                        </div>
                    </div>
                    <div class="dealer-car">
                        <img
                            src="https://images.unsplash.com/photo-1583121274602-3e2820c69888?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80"
                            alt="1963 Apollo 3500GT"
                        />
                        <div class="car-info">
                            <h4>1963 Apollo 3500GT</h4>
                            <p class="car-price">Call for Price</p>
                        </div>
                    </div>
                    <div class="dealer-car">
                        <img
                            src="https://images.unsplash.com/photo-1566473965997-3de9c817e938?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80"
                            alt="2007 Porsche 911 GT3"
                        />
                        <div class="car-info">
                            <h4>2007 Porsche 911 GT3</h4>
                            <p class="car-price">Call for Price</p>
                        </div>
                    </div>
                    <div class="dealer-car">
                        <img
                            src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80"
                            alt="1978 Toyota BJ40 Land Cruiser"
                        />
                        <div class="car-info">
                            <h4>1978 Toyota BJ40 Land Cruiser</h4>
                            <p class="car-price">Call for Price</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- More Bentley Continental GT Speed -->
        <section class="more-models">
            <div class="container">
                <h2>MORE BENTLEY CONTINENTAL GT SPEED</h2>
                <div class="models-grid">
                    <div class="model-car">
                        <img
                            src="https://images.unsplash.com/photo-1563720223185-11003d516935?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80"
                            alt="2025 Bentley Continental GT Speed"
                        />
                        <div class="model-info">
                            <h4>2025 Bentley Continental GT Speed</h4>
                            <p class="model-price">$455,291</p>
                        </div>
                    </div>
                    <div class="model-car">
                        <img
                            src="https://images.unsplash.com/photo-1449824913935-59a10b8d2000?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80"
                            alt="2025 Bentley Continental GT Speed"
                        />
                        <div class="model-info">
                            <h4>2025 Bentley Continental GT Speed</h4>
                            <p class="model-price">$385,320</p>
                        </div>
                    </div>
                    <div class="model-car">
                        <img
                            src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80"
                            alt="2025 Bentley Continental GT Speed"
                        />
                        <div class="model-info">
                            <h4>2025 Bentley Continental GT Speed</h4>
                            <p class="model-price">$377,440</p>
                        </div>
                    </div>
                    <div class="model-car">
                        <img
                            src="https://images.unsplash.com/photo-1566473965997-3de9c817e938?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80"
                            alt="2025 Bentley Continental GT Speed"
                        />
                        <div class="model-info">
                            <h4>2025 Bentley Continental GT Speed</h4>
                            <p class="model-price">$383,950</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <div id="footer"></div>

        <!-- Scripts -->
        <script src="https://cdn.jsdelivr.net/npm/skapi-js@latest/dist/skapi.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/11.0.5/swiper-bundle.min.js"></script>
        <script src="../js/common.js"></script>
        <script src="../js/components.js"></script>
        <script>
            // Product page specific JavaScript
            document.addEventListener("DOMContentLoaded", function () {
                // Swiper 라이브러리가 로드되었는지 확인
                if (typeof Swiper === "undefined") {
                    console.error("Swiper library is not loaded");
                    return;
                }

                // Product Image Swiper 초기화
                const productSwiper = new Swiper(".product-swiper", {
                    loop: false,
                    slidesPerView: 1,
                    spaceBetween: 0,
                    navigation: {
                        nextEl: ".swiper-button-next",
                        prevEl: ".swiper-button-prev",
                    },
                    pagination: {
                        el: ".swiper-pagination",
                        clickable: true,
                    },
                    on: {
                        slideChange: function () {
                            updateThumbnails(this.activeIndex);
                        },
                    },
                });

                // Thumbnail 클릭 이벤트
                const thumbnails = document.querySelectorAll(".thumbnail");
                thumbnails.forEach((thumb, index) => {
                    thumb.addEventListener("click", function () {
                        const slideIndex = parseInt(
                            this.getAttribute("data-slide")
                        );
                        productSwiper.slideTo(slideIndex);
                        updateThumbnails(slideIndex);
                    });
                });

                // Thumbnail 활성화 상태 업데이트
                function updateThumbnails(activeIndex) {
                    thumbnails.forEach((thumb, index) => {
                        const slideIndex = parseInt(
                            thumb.getAttribute("data-slide")
                        );
                        thumb.classList.toggle(
                            "active",
                            slideIndex === activeIndex
                        );
                    });
                }

                // Tab 기능
                const tabBtns = document.querySelectorAll(".tab-btn");
                const tabPanes = document.querySelectorAll(".tab-pane");

                tabBtns.forEach((btn) => {
                    btn.addEventListener("click", function () {
                        const targetTab = this.getAttribute("data-tab");

                        // 모든 active 클래스 제거
                        tabBtns.forEach((b) => b.classList.remove("active"));
                        tabPanes.forEach((p) => p.classList.remove("active"));

                        // 클릭된 탭과 해당 패널에 active 클래스 추가
                        this.classList.add("active");
                        const targetPane = document.getElementById(targetTab);
                        if (targetPane) {
                            targetPane.classList.add("active");
                        }
                    });
                });

                // 초기 썸네일 상태 설정
                updateThumbnails(0);
            });

            /* 좋아요 기능 */
            document
                .querySelector(".fa-heart")
                .addEventListener("click", async function () {
                    if (!skapi.user) {
                        alert("로그인이 필요합니다.");
                        return;
                    }

                    const productId = this.dataset.productId;
                    console.log("productId : ", productId);

                    // 상품명 & 이미지 가져오기
                    const productName = document
                        .querySelector(".product-info h1")
                        ?.innerText.trim();
                    const productImage = document
                        .querySelector(".swiper-slide img")
                        ?.getAttribute("src");

                    console.log("productName : ", productName);
                    console.log("productImage : ", productImage);

                    try {
                        // 중복 좋아요 체크
                        const res = await skapi.getRecords({
                            table: {
                                name: "likes",
                                access_group: "private",
                            },
                            unique_id: productId,
                        });
                        console.log("res : ", res);

                        if (res.list.length > 0) {
                            alert("이미 좋아요한 상품입니다.");
                        } else {
                            // 좋아요 데이터 저장
                            await skapi.postRecord(
                                {
                                    liked: true,
                                    productName,
                                    productImage,
                                },
                                {
                                    table: {
                                        name: "likes",
                                        access_group: "private",
                                    },
                                    unique_id: productId,
                                }
                            );
                            alert("좋아요 완료!");
                            this.classList.add("liked");
                        }
                    } catch (err) {
                        console.error(err);
                        alert("좋아요 처리 중 오류가 발생했습니다.");
                    }
                });

            // 좋아요 토글 기능
            async function toggleLike() {
                try {
                    const heartIcon = document.querySelector(
                        ".product-actions .btn-icon .fa-heart"
                    );
                    const isCurrentlyLiked =
                        heartIcon.classList.contains("liked");

                    if (isCurrentlyLiked) {
                        // 좋아요 취소
                        await skapi.deleteRecords({
                            table: "user_likes",
                            reference: PRODUCT_INFO.record_id,
                        });

                        heartIcon.style.color = "#333";
                        heartIcon.classList.remove("liked");

                        // 간단한 피드백
                        showNotification("좋아요를 취소했습니다");
                    } else {
                        // 좋아요 추가
                        await skapi.postRecord(
                            {
                                product_name: PRODUCT_INFO.name,
                                product_image: PRODUCT_INFO.image,
                                liked_at: Date.now(),
                            },
                            {
                                table: "user_likes",
                                reference: PRODUCT_INFO.record_id,
                            }
                        );

                        heartIcon.style.color = "#ff4757";
                        heartIcon.classList.add("liked");

                        // 간단한 피드백
                        showNotification("좋아요에 추가했습니다");
                    }
                } catch (error) {
                    console.error("좋아요 처리 실패:", error);
                    showNotification("오류가 발생했습니다");
                }
            }

            // 알림 메시지 표시
            function showNotification(message) {
                // 기존 알림이 있으면 제거
                const existingNotification =
                    document.querySelector(".notification");
                if (existingNotification) {
                    existingNotification.remove();
                }

                // 새 알림 생성
                const notification = document.createElement("div");
                notification.className = "notification";
                notification.textContent = message;
                notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: #333;
        color: white;
        padding: 10px 20px;
        border-radius: 5px;
        z-index: 1000;
        opacity: 0;
        transition: opacity 0.3s ease;
    `;

                document.body.appendChild(notification);

                // 애니메이션
                setTimeout(() => (notification.style.opacity = "1"), 10);
                setTimeout(() => {
                    notification.style.opacity = "0";
                    setTimeout(() => notification.remove(), 300);
                }, 2000);
            }

            // 페이지 로드 시 실행
            // document.addEventListener("DOMContentLoaded", function () {
            //     // 기존 초기화 코드가 실행된 후에 좋아요 기능 초기화
            //     setTimeout(() => {
            //         // 로그인 상태 확인
            //         if (skapi.user) {
            //             checkLikeStatus();

            //             // 좋아요 버튼 클릭 이벤트
            //             const likeBtn = document.querySelector(
            //                 ".product-actions .btn-icon"
            //             );
            //             if (likeBtn) {
            //                 likeBtn.addEventListener("click", toggleLike);
            //             }
            //         }

            //         // 헤더의 좋아요 목록 버튼 클릭 이벤트
            //         const headerLikeBtn = document.querySelector(
            //             ".nav-icons .fa-heart"
            //         ).parentElement;
            //         if (headerLikeBtn) {
            //             headerLikeBtn.addEventListener("click", () => {
            //                 if (skapi.user) {
            //                     window.location.href = "likes.html";
            //                 } else {
            //                     showNotification("로그인이 필요합니다");
            //                 }
            //             });
            //         }
            //     }, 1000);
            // });
        </script>
    </body>
</html>
